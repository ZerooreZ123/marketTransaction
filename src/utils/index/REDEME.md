# 导航

- [指标算法程序设计规范](#指标算法程序设计规范)
    - [目录结构](#目录结构)
    - [代码书写规范](#代码书写规范)
        - [通用函数](#通用函数)
        - [计算程式入口](#计算程式入口)
        - [具体程序](#具体程序)
- [指标完成进度](#指标完成进度)

# 指标算法程序设计规范

## 目录结构

```Bash
.
├── Common.js           # 公共函数库
├── complete            # 计算程序目录
│   ├── index.js        # 计算程序库统一入口
│   └── 具体算法文件
├── index.js            # 计算程序总入口
└── REDEME.md           # 文档说明及完成进度
```

## 代码书写规范

> 方便之后其它迁移, 统一使用CommonJS模块规范

### 通用函数

> Common.js

> 存放通用计算函数, 返回实例化后的Common对象

Common对象存放初始数据的拷贝, 使用中将需要缓存的数据放入data对象中用于下次直接使用.

Common对象中的方法可分为通用方法和特殊方法:

1. 通用方法: 直接以方法名命名, 总是返回计算后的数据, 一般不修改data属性(可视实际需求而定), 如: MAX、REF等;
2. 特殊方法: 一般通过复杂计算才能求出所需结果, 普遍会与data属性交互, 总是返回所需值, 如: getSTD、getSMA等;

需要注意:

* (**重要**)当使用`FUNC = params => params`方式且方法中使用了this指针, 则需在对象的构造函数中捆绑this指针, 如: `this.FUNC = this.FUNC.bind(this);`
* (**重要**)当需要使用data缓存数据时**切记**在方法中直接搜索值, 有则返回, 无则继续计算!
* (**建议**)为保证程式通用性传参方式建议使用结构传参, 且key标志数据的键名, day(s)表示天数, index表示数据下标.
* (**建议**)通用方法使用方法名直接命名通俗易懂, 特殊方法建议方法名前加上目的性词汇, 如get(返回数据)、set(修改数据).
* 由于指标众多, 为降低程式复杂性, 代码书写应通俗易懂, 高效规范, 可通过通用工具库lodash来减少代码量.
* 用到递归时应考虑前迭代后递归的设计原则保证程序通用与高效.

### 计算程式入口

> complete/index.js

> 计算程式的入口, 外部使用通过此程序找到所需的程序

### 具体程序

> complete/NAME.js

具体各个计算程序的代码文件

* 使用通用魔板

```js
module.exports = function BOLL({data, close, open, low, high, common, otherParams}) {
  // 获取Common对象缓存的数据
  let vdata = common.getData();
  // 外部使用时用到的键名
  const keys = [];
  data.map((item, index) => {
    if(vdata[index][keys[0]] !== undefined){
      // 如果缓存对象已有数据则直接获取
      keys.forEach(key => item[key] = vdata[index][key]);
    }else{
      /* *****具体程序代码******
       * 当需要缓存的数据存放在vdata[index]下
       * 当外部需要数据应同时存放在item及vdata[index]下
       * **********************/
    }
  })
  return {keys};
}
```

# 指标完成进度

指标名 | 是否完成 | 说明
------ | -------- | ----
MACD   | [X]      | -
BOLL   | [X]      | -
YGZF   | [X]      | 自定义-顶底机遇
DMI    | [X]      | -
KDJ    | [X]      | -
TRIX   | []       | -
CR     | []       | -
MA     | []       | -

